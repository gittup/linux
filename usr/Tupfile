include_rules
modname = usr
#
# kbuild file for usr/ - including initramfs image
#

# NOTES: Must remove usr/ prefix from initramfs_data.S and gen_initramfs_list.sh

# Generate builtin.c based on initramfs_data.c
obj-@(BLK_DEV_INITRD) := initramfs_data.S

hostprogs-y += gen_init_cpio.c
CFLAGS_gen_init_cpio.c += -I$(LINUX_ROOT)/include
CFLAGS_gen_init_cpio.c += -I$(LINUX_ROOT)/arch/@(ARCH)/include
include $(LINUX_ROOT)/host.tup

: ../scripts/gen_initramfs_list.sh | gen_init_cpio |> sh %f -o %o |> initramfs_data.cpio.gz

generated_headers += initramfs_data.cpio.gz

include $(LINUX_ROOT)/linux.tup
