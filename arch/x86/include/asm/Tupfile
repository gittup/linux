include_rules
include $(LINUX_ROOT)/compiler.tup

: asm-offsets.c | $(compiler_proper) |> ^ ASM-OFFSET %o^ $(CC) $(CFLAGS) -Wa,-mtune=generic32 -fwrapv -D"KBUILD_STR(s)=#s" -D"KBUILD_BASENAME=KBUILD_STR(asm_offsets)" -D"KBUILD_MODNAME=KBUILD_STR(asm_offsets)" -fverbose-asm -S %f -o %o |> asm-offsets.s
: asm-offsets.s |> ^ ASM-OFFSET %o^ (set -e; echo "#ifndef __ASM_OFFSETS_H__"; echo "#define __ASM_OFFSETS_H__"; echo "/*"; echo " * DO NOT MODIFY."; echo " *"; echo " * This file was generated by Kbuild"; echo " *"; echo " */"; echo ""; sed -ne       "/^->/{s:->#\(.*\):/* \1 */:; s:^->\([^ ]*\) [\$#]*\([^ ]*\) \(.*\):#define \1 \2 /* \3 */:; s:->::; p;}" %f; echo ""; echo "#endif" ) > %o |> asm-offsets.h
