include_rules
modname = pci
#
# Makefile for the PCI bus specific drivers.
#

obj-y		+= access.c bus.c probe.c remove.c pci.c quirks.c \
			pci-driver.c search.c pci-sysfs.c rom.c setup-res.c \
			irq.c
obj-@(PROC_FS) += proc.c
obj-@(SYSFS) += slot.c

obj-@(PCI_LEGACY) += legacy.c
CFLAGS_legacy.c += -Wno-deprecated-declarations

# Build PCI Express stuff if needed
obj-@(PCIEPORTBUS) += pcie/built-in.o

obj-@(HOTPLUG) += hotplug.c

# Build the PCI Hotplug drivers if we were asked to
obj-@(HOTPLUG_PCI) += hotplug/built-in.o
ifdef HOTPLUG_PCI
obj-y += hotplug-pci.c
endif

# Build the PCI MSI interrupt support
obj-@(PCI_MSI) += msi.c

# Build the Hypertransport interrupt support
obj-@(HT_IRQ) += htirq.c

# Build Intel IOMMU support
obj-@(DMAR) += dmar.c iova.c intel-iommu.c

obj-@(INTR_REMAP) += dmar.c intr_remapping.c

obj-@(PCI_IOV) += iov.c

#
# Some architectures use the generic PCI setup functions
#
obj-@(X86) += setup-bus.c
obj-@(ALPHA) += setup-bus.c setup-irq.c
obj-@(ARM) += setup-bus.c setup-irq.c
obj-@(PARISC) += setup-bus.c
obj-@(SUPERH) += setup-bus.c setup-irq.c
obj-@(PPC) += setup-bus.c
obj-@(MIPS) += setup-bus.c setup-irq.c
obj-@(X86_VISWS) += setup-irq.c
obj-@(MN10300) += setup-bus.c

#
# ACPI Related PCI FW Functions
#
obj-@(ACPI)    += pci-acpi.c

# Cardbus & CompactPCI use setup-bus
obj-@(HOTPLUG) += setup-bus.c

obj-@(PCI_SYSCALL) += syscall.c

obj-@(PCI_STUB) += pci-stub.c

ifeq (@(PCI_DEBUG),y)
EXTRA_CFLAGS += -DDEBUG
endif
include $(LINUX_ROOT)/linux.tup
