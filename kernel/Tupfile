include_rules
generated_headers += ../include/linux/utsrelease.h
generated_headers += timeconst.h
generated_headers += config_data.h

: timeconst.pl |> ^ TIMECONST @(HZ)^ perl %f @(HZ) > %o |> timeconst.h

# TODO: Generate this?
: existing-config |> ^ GZIP %o^ cat %f | gzip > %o |> config_data.gz

: config_data.gz ../scripts/bin2c |> ^ BIN2C %o^ (echo "static const char kernel_config_data[] __used = MAGIC_START" && cat config_data.gz | ../scripts/bin2c && echo "MAGIC_END;") > %o |> config_data.h

run $(LINUX_ROOT)/linux.py
